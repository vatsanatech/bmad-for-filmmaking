workflow_id: screenplay
name: "Screenplay Development (Interactive + Multi-Dialect)"
version: 6.0.0-multi-dialect
category: development
description: |
  **INTERACTIVE CO-WRITING + MULTI-DIALECT SUPPORT** - Creates screenplay through questions, with automatic multi-language dialect support.

  **NEW IN v6.0**: Automatic multi-dialect screenplay creation!
  If character-bible was created in multiple dialects, screenplay automatically creates versions for each dialect.

  **3-PHASE PROCESS**:

  **Phase 0: Dialect Auto-Detection (NEW!)**
  - Reads dialect preferences from character-bible workflow
  - If multi-dialect character-bible exists â†’ Creates screenplay per dialect
  - Dialogue automatically adapted to each regional language
  - Same scene structure, localized dialogue

  **Phase 1: Screenplay Questions (15 questions)**
  - Screenplay Structure Writer asks 10 questions (style, pacing, scenes)
  - Dialogue Writer asks 5 questions (language ratio, dialect, memorable lines)
  - Understands YOUR vision for scenes, dialogue, visual storytelling

  **Phase 2: Collaborative Refinement**
  - Present structure approach based on answers
  - You refine key scenes/dialogue beats
  - Iterates until screenplay direction feels RIGHT

  **Phase 3: Screenplay Creation**
  - Structure Writer creates scenes/action (same for all dialects)
  - Dialogue Writer polishes dialogue per dialect (from character-bible voice profiles)
  - **IF MULTI-DIALECT**: Creates separate screenplay-{dialect}.md files
  - Two-agent Bollywood authentic approach
  - Output: Complete screenplay(s) matching your vision

  **BOLLYWOOD TWO-AGENT MODEL**:
  1. Screenplay Structure Writer - Visual foundation (scenes, action, pacing)
  2. Dialogue Writer (Samvad Lekhak) - Impactful dialogue per dialect

  Creates UNIQUE screenplay based on your 15 answers, not generic template.
  Supports single language (default: Hindi) OR multiple Indian dialects automatically.

  This runs AFTER character-bible in development workflow.

  Input: Approved character bible(s) - single OR multi-dialect
  Output: Professional screenplay(s) - single file OR multiple dialect-specific files

lead_agent: screenplay-structure-writer
supporting_agents:
  - dialogue-writer
  - master-story-director
  - genre-specific-agent

inputs:
  required:
    - project_name: "Project directory name (e.g., 'band-darwaza')"

  optional:
    - language: "Language/dialect specification (default: Simple Bollywood Hindi)"
      # Options:
      # - "Simple Bollywood Hindi" (60-70% Hindi, 30-40% English - DEFAULT)
      # - "Pure Hindi" (90% Hindi, formal/literary)
      # - "Hinglish" (50-50 mix, urban youth)
      # - "Haryanvi" (rural Haryana dialect)
      # - "Bihari" (Bhojpuri influenced)
      # - "Marathi-influenced" (Mumbai local)
      # - "Punjabi-influenced" (energetic, expressive)

context_requirements:
  read:
    - "project/{project_name}/genre-analysis.md"
    - "project/{project_name}/story-synopsis.md"
    - "project/{project_name}/beat-sheet.md"
    - "project/{project_name}/character-bible.md (or dialect-specific versions)"

  write:
    - "project/{project_name}/screenplay-structure.md"
    - "project/{project_name}/screenplay.md (or dialect-specific versions)"

process:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # STEP 0: DIALECT AUTO-DETECTION (NEW!)
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - step: 0
    name: "DIALECT AUTO-DETECTION & FILE SETUP"
    agent: screenplay-structure-writer
    action: |
      **ğŸ”´ ANNOUNCE TO USER (MANDATORY):**
      ```
      â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      ğŸ“ SCREENPLAY WORKFLOW â€” STARTING
      â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      ğŸ“ STEP 0 of 4 â€” Reading ALL Project Files
      â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      Reading: genre-analysis.md + story-synopsis.md +
               character-bible.md + beat-sheet.md
      ```
      **ğŸ”´ MANDATORY: Read ALL these files BEFORE proceeding:**
      - `project/{project_name}/genre-analysis.md`
      - `project/{project_name}/story-synopsis.md`
      - `project/{project_name}/character-bible.md` (or dialect versions)
      - `project/{project_name}/beat-sheet.md` (if exists)

      **Auto-detect dialect preferences from character-bible:**

      **CHECK CHARACTER-BIBLE FILES**:

      Look in `project/{project_name}/` for:
      - Single file: `character-bible.md` â†’ SINGLE DIALECT
      - Multiple folders: `hindi/`, `tamil/`, `telugu/` (with character-bible.md inside each) â†’ MULTI-DIALECT

      ---

      **IF SINGLE DIALECT FOUND**:
      - Read: `character-bible.md`
      - Extract: Language/dialect used (default: Hindi)
      - Setup: Create single screenplay file
      - Output: `screenplay.md`

      ---

      **IF MULTI-DIALECT FOUND**:
      - Count dialect folders: hindi/, tamil/, telugu/, etc.
      - Extract: List of dialects (Hindi, Tamil, Telugu, Bengali, etc.)
      - Setup: Prepare to create screenplay in each dialect folder
      - Output: `hindi/screenplay.md`, `tamil/screenplay.md`, `telugu/screenplay.md`, etc.

      **READ LOCALIZATION SETTINGS**:
      From each character-bible file, extract:
      - Localization depth (dialogue-only / full cultural)
      - Character names (adapted or universal)
      - Speech patterns per dialect
      - Cultural references strategy

      ---

      **INFORM USER**:

      IF SINGLE DIALECT:
      ```
      âœ“ Character Bible detected: Single dialect (Hindi)
      â†’ Will create: screenplay.md
      ```

      IF MULTI-DIALECT:
      ```
      âœ“ Character Bibles detected: 3 dialects (Hindi, Tamil, Telugu)
      â†’ Will create:
         - hindi/screenplay.md (Hindi dialogue)
         - tamil/screenplay.md (Tamil dialogue)
         - telugu/screenplay.md (Telugu dialogue)

      Same scenes, same structure, localized dialogue per dialect.
      ```

      **CONTINUE TO STEP 1** (Screenplay questions - same for all dialects)

    outputs:
      - Dialect count and list detected
      - File naming strategy set
      - Localization settings loaded

    duration: "1-2 min (automatic detection)"

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 1: SCREENPLAY QUESTION PHASE
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - step: 1
    name: "PHASE 1A - Screenplay Structure Questions (10 questions)"
    agent: screenplay-structure-writer

    action: |
      **ğŸ”´ ANNOUNCE TO USER (MANDATORY):**
      ```
      âœ… STEP 0 complete â€” All project files read.
      â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      ğŸ“ STEP 1 of 4 â€” Screenplay Questions (15 questions)
      â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      ```
      **Screenplay Structure Writer asks 10 questions:**

      Reference: `.bmad-film/agents/screenplay-structure-writer.md`

      **A. SCREENPLAY STYLE (4 questions)**:

      Q1. Dialogue vs Visual Balance - Dialogue-heavy? Balanced? Visual-first?
      Q2. Scene Length - Quick cuts? Moderate? Longer takes? Varied?
      Q3. Opening Scene - Character? World? Hook? Mood? Inciting incident?
      Q4. Closing Scene - Last image/moment kya hona chahiye?

      **B. PACING & STRUCTURE (3 questions)**:

      Q5. Pacing Strategy - Fast & tight? Measured? Building? Wave pattern?
      Q6. Subtext Level - Direct? Moderate? Heavy subtext? Layered?
      Q7. Scene Transitions - Hard cuts? Motivated? Time jumps? Thematic?

      **C. SPECIFIC SCENES (3 questions)**:

      Q8. Must-Have Scenes - Koi specific scenes clearly imagine kar rahe ho?
      Q9. Emotional Beats Placement - Audience ko kab kya feel (map 3-5 moments)?
      Q10. Montages/Special Sequences - Training? Time passage? Flashbacks?

      **Collect all 10 answers before proceeding to Step 2.**

    duration: "10-15 min"

  - step: 2
    name: "PHASE 1B - Dialogue/Language Questions (5 questions)"
    agent: dialogue-writer

    action: |
      **Dialogue Writer asks 5 language questions:**

      Reference: `.bmad-film/agents/dialogue-writer.md`

      **LANGUAGE & VOICE (5 questions)**:

      Q11. Hindi-English Ratio - Default 60-70% Hindi theek hai? Ya adjust?
      Q12. Dialect/Regional Flavor - Koi specific dialect? (Haryanvi, Punjabi, etc.)
      Q13. Formality Level - Formal? Casual? Mixed? Character-based?
      Q14. Memorable Lines - Koi specific lines/quotes include karna hai?
      Q15. Dialogue Density - Talky? Balanced? Minimal? Action-driven?

      **Collect all 5 answers before proceeding.**

    duration: "5-10 min"

  - step: 3
    name: "Answer Synthesis & Screenplay Architecture"
    agent: screenplay-structure-writer
    collaboration:
      - dialogue-writer

    action: |
      **Synthesize ALL 15 answers:**

      ```
      Perfect! Screenplay vision clear hai:

      âœ“ Style: [Q1-Q4 answers - dialogue/visual balance, pacing]
      âœ“ Structure: [Q5-Q7 - pacing, subtext, transitions]
      âœ“ Scenes: [Q8-Q10 - must-haves, beats, montages]
      âœ“ Language: [Q11-Q15 - ratio, dialect, formality, density]

      Yeh sahi hai? Final confirm before screenplay creation?
      ```

      **Apply Decision Tree**:

      Based on answers, determine:
      - Scene length/count (Q2 - quick cuts = 15-20 scenes, longer = 8-12)
      - Pacing strategy (Q5 - fast/measured/building)
      - Subtext level (Q6 - affects dialogue style)
      - Language mix (Q11-Q13 - per character if needed)
      - Montages needed (Q10)
      - Opening/closing specific (Q3, Q4)

      **Architecture internally**:
      - Scene breakdown based on answers
      - Emotional beat placement from Q9
      - Must-have scenes from Q8 integrated
      - Language/dialect strategy from Q11-Q13

    duration: "10 min"

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 2: COLLABORATIVE REFINEMENT (Optional)
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - step: 4
    name: "PHASE 2 - Present Structure Approach (Optional Refinement)"
    agent: screenplay-structure-writer

    action: |
      **Present screenplay approach for review:**

      "Yeh structure bana rahe hain based on answers:

      - Scene count: [Estimated based on Q2]
      - Opening: [Based on Q3 answer]
      - Key emotional beats: [Q9 placements]
      - Must-have scenes: [Q8 integrated]
      - Closing: [Based on Q4 answer]

      Yeh direction sahi hai? Kuch adjust?"

      If user wants changes, adjust before full screenplay.
      If approved, proceed to Step 5.

    duration: "5 min (optional)"

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # PHASE 3: SCREENPLAY CREATION
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - step: 5
    name: "Read Project Context (CRITICAL FOR CONSISTENCY)"
    agent: screenplay-structure-writer

    action: |
      **CRITICAL: Read ALL previous workflow outputs FIRST:**

      **MUST READ** (from previous workflows):
      1. `project/{project_name}/genre-analysis.md` - Genre, tone, visual style
      2. `project/{project_name}/story-synopsis.md` - **BOTH versions** (continuous narrative + scene-by-scene)
      3. `project/{project_name}/beat-sheet.md` - Beat-by-beat story breakdown, emotional mapping, pacing
      4. `project/{project_name}/character-bible.md` - Complete character profiles, voices, arcs
         - OR if multi-dialect: `project/{project_name}/{dialect}/character-bible.md` (read all dialects)

      **Extract for screenplay:**
      - Genre and tone (determines screenplay style) â†’ FROM genre-analysis
      - All story beats (must be covered) â†’ FROM beat-sheet (beat-by-beat breakdown)
      - Emotional progression map â†’ FROM beat-sheet (highs/lows placement)
      - Pacing rhythm â†’ FROM beat-sheet (fast/measured/slow burn)
      - Character roster with voice profiles â†’ FROM character-bible
      - Character speech patterns (Q4 answers from character-bible)
      - Key relationships (affects dialogue dynamics) â†’ FROM character-bible relationships section
      - Scene progression (exact sequence) â†’ FROM story-synopsis (scene-by-scene) + beat-sheet
      - Visual style notes â†’ FROM genre-analysis

      **CONSISTENCY CHECK**:
      - Screenplay scenes MUST match beat-sheet beats (all beats covered)
      - Screenplay pacing MUST match beat-sheet rhythm
      - Screenplay emotional arcs MUST match beat-sheet emotional mapping
      - Dialogue voices MUST match character-bible speech patterns
      - Genre tone MUST match genre-analysis recommendations

      **Combine previous outputs with Q1-Q15 answers to create screenplay.**

    outputs:
      - Project understanding
      - Character roster with voice profiles
      - Answers + context combined

  - step: 6
    name: "Scene Structure Planning (Based on Q1-Q10 Answers)"
    agent: screenplay-structure-writer
    collaboration:
      - master-story-director (structure oversight)
      - genre-specific-agent (genre conventions)

    action: |
      **Break story into scenes using Q1-Q10 answers:**

      **Scene Count determined by Q2 answer**:
      - Quick cuts (Q2) = 15-20 short scenes
      - Moderate = 10-15 scenes
      - Longer takes = 8-12 scenes

      For each scene identify:
      - Location (INT/EXT, specific place)
      - Time of day
      - Characters present
      - What happens (action beats from story)
      - Emotional tone (match Q9 emotional beat map)
      - Dialogue moments (who speaks, about what)
      - Scene purpose (plot/character/theme)
      - Estimated duration

      **Create scene flow using Q3, Q4, Q8, Q9 answers**:
      - **Opening scene from Q3** (character? world? hook?)
      - Development scenes (build story)
      - **Must-have scenes from Q8** (integrate specifically)
      - **Emotional beats from Q9** (place at right moments)
      - Climax scene (peak tension/emotion)
      - **Closing scene from Q4** (specific final image/moment)

      **Apply Q10 montages**:
      - Training montage (if requested)
      - Time passage (if requested)
      - Flashbacks (if requested)

      **Pacing from Q5**:
      - Fast & tight = minimal setup, jump to action
      - Building = slow start, accelerate to climax
      - Wave = peaks + valleys rhythm

      Verify:
      - All story beats covered
      - Q9 emotional beats placed correctly
      - Q8 must-have scenes included
      - Character arcs progress
      - Genre conventions honored

    outputs:
      - Complete scene breakdown (answer-based)
      - Q9 emotional beats mapped to scenes
      - Q8 must-haves integrated

  - step: 7
    name: "PHASE 3A - Write Screenplay Structure (Based on Q1-Q10)"
    agent: screenplay-structure-writer

    action: |
      **Write STRUCTURE DRAFT using Q1-Q10 answers:**

      This draft includes:
      âœ… Complete scene headings (INT/EXT, LOCATION - TIME)
      âœ… Detailed action lines (visual storytelling based on Q1)
      âœ… Character introductions (memorable first appearances)
      âœ… Scene descriptions and atmosphere
      âœ… Character behavior and movement
      âœ… PLACEHOLDER DIALOGUE (functional, shows flow and tone)

      **Apply Q1 (Dialogue vs Visual Balance)**:
      - Dialogue-heavy â†’ Longer dialogue blocks, less action description
      - Visual-first â†’ Detailed action lines, minimal dialogue
      - Balanced â†’ Equal weight to both

      **Apply Q2 (Scene Length)**:
      - Quick cuts â†’ Scenes 0.5-1 page each
      - Moderate â†’ Scenes 1-3 pages
      - Longer takes â†’ Scenes 3-5 pages

      **Apply Q6 (Subtext Level)**:
      - Direct â†’ Placeholder dialogue says what it means
      - Heavy subtext â†’ Placeholder shows tension, avoidance
      - Mark silences and beats

      **Apply Q7 (Transitions)**:
      - Hard cuts â†’ Just scene heading, no bridge
      - Motivated â†’ Link scenes with action/sound/theme
      - Time jumps â†’ Add "LATER" / "DAYS LATER"

      For EACH scene write:

      **1. SCENE HEADING**:
      ```
      INT. LOCATION - TIME
      or
      EXT. LOCATION - TIME
      ```

      **2. SCENE ESTABLISHMENT** (opening lines):
      - Atmosphere and mood (genre-appropriate)
      - Location details that matter
      - Time/lighting feeling
      - Environmental sounds or energy
      - Sets visual tone

      **3. ACTION LINES** (what we see/hear):
      - Present tense, active voice
      - Visual description (what camera captures)
      - Character behavior and movement
      - Emotional states SHOWN (not told)
      - Important props/objects
      - Environment interactions
      - Short paragraphs (3-4 lines max - readable)

      **4. PLACEHOLDER DIALOGUE**:
      - Basic Hindi-English mix (from character profiles)
      - Shows information being conveyed
      - Shows emotional tone
      - Shows conversation flow
      - CHARACTER-APPROPRIATE (references character bible)
      - NOT final impactful lines (dialogue writer handles that)

      **GENRE-SPECIFIC STYLE**:
      Apply appropriate genre screenplay style:
      - Thriller: Tension in descriptions, observational details
      - Romance: Emotional atmosphere, character connection shown
      - Horror: Dread and unease, sensory details, what's NOT seen
      - Comedy: Setup/payoff structure, physical comedy opportunities
      - Action: Dynamic movement, clear geography, impact

      **RULES - DO NOT INCLUDE**:
      âŒ NO camera directions (no "CLOSE-UP", "WIDE SHOT")
      âŒ NO technical notes (lighting, sound, editing)
      âŒ NO shot breakdowns
      âŒ NO final polished dialogue (placeholder only)

      **ONLY WRITE**:
      âœ… Scene headings
      âœ… Action lines (visual description)
      âœ… Placeholder dialogue (functional)
      âœ… Scene flow and structure

      Keep it CLEAN and VISUAL. Structure foundation for dialogue.

    quality_standards: |
      Every scene must meet:

      âœ“ **Format**: Industry standard (INT/EXT, proper action/dialogue format)
      âœ“ **Visual**: Action lines show, don't tell
      âœ“ **Clear**: Easy to read, easy to visualize
      âœ“ **Genre-appropriate**: Matches genre conventions
      âœ“ **Shootable**: Director can stage, actors can perform
      âœ“ **Character-accurate**: Behavior matches character bible
      âœ“ **Clean**: NO technical notes or camera directions
      âœ“ **Placeholder dialogue**: Shows flow, NOT final impact

    outputs:
      - Complete screenplay STRUCTURE draft
      - All scenes written with action and placeholder dialogue
      - Genre style applied
      - Ready for dialogue writing phase

      Save as: `project/{project_name}/screenplay-structure.md`

  - step: 8
    name: "PHASE 3B - Craft Final Dialogue (Based on Q11-Q15)"
    agent: dialogue-writer

    inputs_from_previous:
      - Screenplay structure with placeholder dialogue
      - Character Bible with voice profiles
      - Q11-Q15 answers (language, dialect, formality, memorable lines, density)

    action: |
      **Replace ALL placeholder dialogue using Q11-Q15 answers:**

      **Apply Q11 (Hindi-English Ratio)**:
      - 60-70% Hindi (default) â†’ Standard Bollywood mix
      - More Hindi (80-90%) â†’ Traditional/regional characters
      - More English (40-50%) â†’ Urban/elite characters
      - Character-specific â†’ Different per person

      **Apply Q12 (Dialect)**:
      - NO DIALECT â†’ Standard Bollywood Hindi
      - LIGHT REGIONAL â†’ Few dialect words for flavor
      - HEAVY REGIONAL â†’ Full Haryanvi/Punjabi/Bhojpuri/etc. for authenticity

      **Apply Q13 (Formality)**:
      - Formal â†’ "Aap" form, proper Hindi, educated vocabulary
      - Casual â†’ "Tu/tum" form, street-smart mixing
      - Character-based â†’ Different formality per person

      **Apply Q14 (Memorable Lines)**:
      - If user gave specific lines â†’ Include EXACTLY as given
      - Craft dialoguebaazi moments at key scenes
      - One-liners, philosophical zingers, quotable lines

      **Apply Q15 (Dialogue Density)**:
      - Talky â†’ Longer dialogue blocks, conversations
      - Balanced â†’ Dialogue when needed, silence when powerful
      - Minimal â†’ Terse lines, mark silences, Gulzar-style
      - Action-driven â†’ Brief functional dialogue

      **Process**:

      1. **Read screenplay structure thoroughly**:
         - Note all placeholder dialogue
         - Understand scene emotional arcs
         - Identify character dynamics per scene
         - Track conversation power dynamics

      2. **Consult Character Bible for each character**:
         - Hindi-English ratio (e.g., 70% Hindi, 30% English)
         - Vocabulary level (educated/simple/technical)
         - Speech rhythm (fast/slow/interrupted)
         - Verbal tics (repeated phrases)
         - Emotional expression style
         - Background (class, education, region)

      3. **Apply Genre Dialogue Style**:
         - **Thriller**: Terse, subtext-heavy, tension in casual talk
         - **Romance**: Emotional, expressive, vulnerability shown
         - **Horror**: Believable fear, fragmented under terror
         - **Comedy**: Wit, timing, absurd logic, rapid-fire
         - **Action**: Short punchy lines, one-liners, urgency

      4. **Apply Language/Dialect** (user-specified or default):
         - Default: Simple Bollywood Hindi (60-70% Hindi, 30-40% English)
         - Natural code-switching (tech/modern = English, emotions = Hindi)
         - If dialect specified (Haryanvi/Bihari/etc): Apply consistently
         - Balance authenticity with accessibility

      5. **Write Final Dialogue**:
         - Each character sounds DISTINCT (identify speaker without name)
         - Actable (sounds natural when spoken aloud)
         - Has subtext (what's unsaid matters)
         - Reveals character (not just information)
         - Moves story or deepens character
         - Fits emotional tone of scene
         - Create memorable moments (quotable lines where appropriate)

      6. **Quality Check**:
         - Read aloud test (must sound natural)
         - Character voice consistency check
         - No on-the-nose exposition
         - Subtext present
         - Genre tone maintained
         - Language specification followed

      **BOLLYWOOD DIALOGUE QUALITY**:
      - Impactful, not flat
      - Memorable lines (audiences remember dialogue)
      - Character-specific voices
      - Natural speech (not literary)
      - Emotional authenticity
      - Cultural authenticity

    quality_standards: |
      Every dialogue must meet:

      âœ“ **Distinct**: Can identify speaker without seeing name
      âœ“ **Natural**: Sounds real when spoken aloud
      âœ“ **Layered**: Has subtext, what's unsaid matters
      âœ“ **Genre-appropriate**: Matches thriller/romance/horror/comedy/action style
      âœ“ **Language-accurate**: Follows Hindi-English ratio from character bible
      âœ“ **Dialect-consistent**: If specified, applied throughout
      âœ“ **Actable**: Actor can deliver with emotion
      âœ“ **Impactful**: Bollywood quality, memorable where appropriate
      âœ“ **No exposition dumps**: Information conveyed naturally

    outputs:
      - Complete screenplay with final dialogue
      - All placeholder dialogue replaced
      - Character voices distinct and consistent
      - Genre-appropriate dialogue style
      - Language/dialect authenticity
      - Bollywood-quality memorable lines

  - step: 9
    name: "Format and Length Verification"
    agent: dialogue-writer

    action: |
      **Verify final screenplay format and length (answers applied):**

      **Format Check**:
      - Scene headings proper (INT/EXT, LOCATION - TIME)
      - Action lines present tense, visual, short paragraphs
      - Dialogue formatted correctly (character name, dialogue)
      - Character names CAPS on first mention
      - Proper spacing and readability
      - NO technical notes (verify clean)

      **Length Verification**:
      - Count pages (1 page â‰ˆ 1 minute)
      - Target: [X] pages for [X]-minute film
      - If over/under by more than 10%:
        * Identify scenes to trim/expand
        * Adjust dialogue length (not content)
        * Maintain all story beats

      **Readability Check**:
      - Flows smoothly scene to scene
      - Easy to visualize
      - Easy to read aloud
      - Professional appearance

      **Language Check**:
      - Consistent Hindi-English ratios per character
      - Dialect (if specified) consistent throughout
      - Natural code-switching (not forced)
      - Accessible to target audience

    outputs:
      - Formatted screenplay
      - Length verified and adjusted
      - Clean professional format confirmed
      - Language consistency verified

  - step: 10
    name: "Quality Assurance (Answer-Based Verification)"
    agent: master-story-director
    collaboration:
      - screenplay-structure-writer
      - dialogue-writer
      - genre-specific-agent

    action: |
      **Master Story Director reviews screenplay for Q1-Q15 answer usage:**

      **ANSWER INTEGRATION CHECK**:
      - [ ] Q1 (Dialogue vs Visual) applied correctly
      - [ ] Q2 (Scene Length) matches - scenes right size
      - [ ] Q3 (Opening Scene) matches user's vision
      - [ ] Q4 (Closing Scene) matches specific final image
      - [ ] Q5 (Pacing) matches user preference (fast/measured/building)
      - [ ] Q6 (Subtext) level matches answer (direct/heavy/layered)
      - [ ] Q7 (Transitions) style matches (cuts/motivated/jumps)
      - [ ] Q8 (Must-Have Scenes) all included as specified
      - [ ] Q9 (Emotional Beats) placed at specified moments
      - [ ] Q10 (Montages) included if requested
      - [ ] Q11 (Hindi-English Ratio) matches answer per character
      - [ ] Q12 (Dialect) applied if specified
      - [ ] Q13 (Formality) matches per character
      - [ ] Q14 (Memorable Lines) included if user gave specific lines
      - [ ] Q15 (Dialogue Density) matches (talky/balanced/minimal)

      **Structure Check**:
      - All story beats from synopsis present
      - Scene flow logical and engaging
      - Pacing matches Q5 answer
      - Character arcs progress clearly
      - Visual storytelling (show don't tell from Q1)

      **Dialogue Check**:
      - Characters sound distinct
      - Voices consistent with character bible + Q4 answers
      - Subtext level matches Q6
      - Natural, actable dialogue
      - Genre-appropriate style
      - Language ratios match Q11-Q13

      **Genre Check**:
      - Genre conventions honored
      - Tone consistent
      - Audience expectations met

      **Bollywood Quality Check**:
      - Professional format
      - Dialogue has impact (not flat)
      - Memorable moments present
      - Shootable and actable
      - Ready for production

      **If user's Q1-Q15 answers not respected â†’ Send back for revision**

    approval_gate: |
      Master Story Director MUST approve.

      If NOT approved:
      - Identify specific issues (structure/dialogue/genre/language)
      - Route back to appropriate agent for revision
      - Re-review after revision

      If APPROVED:
      - Proceed to finalization

    outputs:
      - Quality approval
      - Revision notes (if needed)
      - Final sign-off

  - step: 11
    name: "Finalize Screenplay"
    agent: dialogue-writer

    action: |
      Create final screenplay document with proper credits:

      **Document Structure**:

      ```
      =====================================
      [PROJECT TITLE]
      [Duration] Minute Film
      Genre: [Genre]
      Language: [Hindi/Hinglish/Dialect]

      Story by: [Genre Specialist Agent Name]
      Character Bible by: BMAD-FILM Character Developer
      Screenplay by: BMAD-FILM Screenplay Structure Writer
      Dialogues by: BMAD-FILM Dialogue Writer (Samvad Lekhak)

      Date: [Date]
      Version: Final Draft 1.0
      =====================================

      FADE IN:

      [Complete screenplay - all scenes with final dialogue]

      FADE OUT.

      =====================================
      END OF SCREENPLAY
      =====================================

      PRODUCTION SUMMARY:

      Runtime: [X] minutes (estimated)
      Total Scenes: [X]
      Locations: [List unique locations]
      Cast: [List all characters with roles]

      Language: [Specification]
      Dialogue Style: [Genre-appropriate description]

      Character Voice Summary:
      - [Character 1]: [Brief voice description]
      - [Character 2]: [Brief voice description]

      Notable Dialogue Moments (Marketing Potential):
      - "[Memorable line 1]"
      - "[Memorable line 2]"
      ```

      **FILE NAMING** (based on Step 0 dialect auto-detection):

      **IF SINGLE DIALECT**:
      Save as: `project/{project_name}/screenplay.md`

      **IF MULTI-DIALECT**:
      Save screenplay in each DIALECT FOLDER:
      - `project/{project_name}/hindi/screenplay.md`
      - `project/{project_name}/tamil/screenplay.md`
      - `project/{project_name}/telugu/screenplay.md`
      - etc. (one file per dialect folder detected in Step 0)

      **Each dialect file contains**:
      - SAME scene structure (INT/EXT, scene headings, action lines)
      - SAME story beats and progression
      - LOCALIZED dialogue:
        - Hindi version: Hinglish dialogue (from character-bible-hindi)
        - Tamil version: Tamil dialogue (from character-bible-tamil)
        - Telugu version: Telugu dialogue (from character-bible-telugu)
        - etc.
      - Character names: As per dialect character-bible (adapted or universal)
      - Cultural references: As per localization depth from character-bible

      **EXAMPLE - Multi-Dialect Scene**:

      **hindi/screenplay.md**:
      ```
      INT. COMMUNITY HALL - EVENING

      Arjun DJ equipment setup kar raha hai.

      MEERA
      (flirty)
      Late ho gaye, DJ sahab.
      ```

      **tamil/screenplay.md**:
      ```
      INT. COMMUNITY HALL - EVENING

      Arun DJ equipment setup pannitu irukkaru.

      MEERA
      (flirty)
      Late agiruchu, DJ sir.
      ```

      **Also Preserve**:
      Keep `screenplay-structure.md` for reference (shows evolution from structure to final)

    outputs:
      - Final complete screenplay file(s)
      - Single file (if single dialect) OR Multiple files (if multi-dialect)
      - Production-ready script per dialect
      - Bollywood-authentic credits (two-agent model)
      - Clean, professional format

success_criteria: |
  Screenplay is successful when:

  âœ“ **Answer-Based**: Screenplay matches ALL 15 answers (Q1-Q15, not generic template)
  âœ“ **Q1-Q7 Structure**: Dialogue/visual balance, scene length, pacing, subtext, transitions match answers
  âœ“ **Q8-Q10 Scenes**: Must-have scenes included, emotional beats placed correctly, montages if requested
  âœ“ **Q11-Q15 Dialogue**: Language ratio, dialect, formality, memorable lines, density match answers
  âœ“ **Structure**: Properly formatted (industry standard)
  âœ“ **Story**: All story beats present
  âœ“ **Visual**: Action lines show, don't tell (per Q1)
  âœ“ **Dialogue**: Natural, impactful, character-specific (Bollywood quality)
  âœ“ **Character Voices**: Distinct per character bible + Q4 speech patterns
  âœ“ **Genre**: Conventions honored, tone consistent
  âœ“ **Language**: Simple Bollywood Hindi (60-70% mix or per Q11)
  âœ“ **Readable**: Easy to read and visualize
  âœ“ **Shootable**: Director can stage scenes
  âœ“ **Actable**: Actors can perform with emotion
  âœ“ **Runtime**: Matches target (Â±30 seconds)
  âœ“ **Clean Format**: NO technical notes or camera directions
  âœ“ **User Feels**: "This is MY screenplay - they understood my vision for scenes + dialogue!"

deliverables:
  primary:
    - file: "project/{project_name}/screenplay.md (single dialect) OR screenplay-{dialect}.md (multi-dialect)"
      description: "Complete screenplay with structure and final dialogue - single file OR multiple dialect-specific files"

  secondary:
    - file: "project/{project_name}/screenplay-structure.md"
      description: "Structure draft with placeholder dialogue (reference - universal for all dialects)"

  multi_dialect_example:
    - "hindi/screenplay.md - Hindi/Hinglish dialogue version"
    - "tamil/screenplay.md - Tamil dialogue version"
    - "telugu/screenplay.md - Telugu dialogue version"

estimated_time: "2-3 hours for 5-minute screenplay (structure + dialogue)"

notes: |
  Screenplay is STEP 4 in development workflow:

  1. Story Synopsis âœ…
  2. Character Bible âœ…
  3. Beat Sheet âœ…
  4. Screenplay â¬…ï¸ (This step)

  BOLLYWOOD TWO-AGENT MODEL (Authentic Industry Practice):

  **Agent 1: Screenplay Structure Writer**
  - Creates visual foundation
  - Scene construction, action lines
  - Placeholder dialogue (functional)
  - Genre-trained for appropriate style

  **Agent 2: Dialogue Writer (Samvad Lekhak)**
  - Crafts final impactful dialogue
  - Character-specific voices
  - Genre-appropriate style
  - Language/dialect expertise

  This separation mirrors Bollywood tradition:
  - "Screenplay: [Name]"
  - "Dialogues: [Name]"

  Benefits:
  - Better specialization (dialogue is an art)
  - Genre-trained agents for both structure and dialogue
  - Dialogue quality matches Bollywood standards
  - Character voices more distinct
  - More control over final product

  Language/Dialect Options:
  - Default: Simple Bollywood Hindi (60-70% Hindi, 30-40% English)
  - Pure Hindi (90% Hindi, formal/literary)
  - Hinglish (50-50, urban youth)
  - Regional dialects: Haryanvi, Bihari, Marathi-influenced, Punjabi-influenced

  Technical specifications come LATER from:
  - Cinematographer (camera, shots)
  - Gaffer (lighting)
  - Sound Designer (sound)
  - Editor (cutting)

  Screenplay = STORY in visual form with powerful dialogue
  NOT = Production manual
